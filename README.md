# Cloud_computing_spbu

Домашнее задание по первой практике - пример с докером и кубером. Каждый пример находится в соответствующей директории.

В обоих случаях в качестве базового примера использовалось одно и то же простое приложение с REST-API интерфейсом для получения предсказаний предобученной модели по входным значениям. В качестве задачи для простоты демонстрации модель была обучена на датасете [Fisher's iris](https://scikit-learn.org/stable/datasets/toy_dataset.html#iris-plants-dataset). Поэтому модель умеет делать предсказания только в формате этого датасета. Никаких дополнительных проверок на валидность входных значений реализовано не было. Пример является исключительно демонстрацией работоспособности контейнеров и локального кластера в обоих примерах, не неся сильной смысловой нагрузки и не пытаясь продемонстрировать аккуратное и оптимальное решение даже такой простой задачи.

## Docker example

Данный пример реализует простой rest api интерфейс с помощью Flask внтури первого контейнера, позволяющий делать http запросы для предсказания класса цветка по входным числовым значениям. База данных используется в связке с Redis Queue для хранения job-ов, при этом сама база данных хранится в отдельном контейнере.

Чтобы запустить пример с докером, необходимо перейти в директорию, куда был скачан репозиторий, и проделать следующие шаги:
```
cd docker_example
docker build -t my_flask_simple_app:v1 ./<docker_example_path_dir>
docker compose up
```

После этого Flask развернет сервер на localhost, адрес для http-запросов должен отобразиться в терминале, обычно это http://127.0.0.1:9995 (порт фиксированный). Данный адрес необходимо скопировать в буфер обмена.

Далее из папки /docker_exmaple запсукаем простое демо приложение на python для общения с развернутым в контейнере сервером: 
```
python terminal_interface.py
```
Появится простой консольный интерфейс, который позволит проверить работоспособность примера.

Дополнительно убедиться в том, что после перезапуска контейнера данные из базы данных не пропадают, можно, если зайти внутрь второго контейнера, содержащего базу данных Redis, через bash-интерфейс, и подключиться к БД через redis-cli и самостоятельно проверить, что база данных не пустая, хотя это излишне. 
---

## Kuber example
Для реализации примера на kubernetes был использован minikube. Пример является расширением примера с докером, но на k8s-кластер.

Чтобы запустить пример с k8s, необходимо перейти в директорию, куда был скачан репозиторий, и запустить скрипт:
```
# Linux
./init_cluster.sh

# Windows (не проверял, сгенерировано ChatGPT)
.\init_cluster.ps1
```
Как альтернатива, можно проделать каждый шаг из .sh скрипта вручную в консоли.

После инициализации кластера в консоли появится адрес http://localhost:<port_id>, номер порта меняется от запуска к запуску. Необходимо скопировать данный адрес в буфер обмена.

После этого можно запустить в той же директории python-скрипт для консольного интерфейса, чтобы протестировать кластер. В качестве адреса передаем тот, что сохранили на предыдущем шаге.

Чтобы закончить работу с кластером, прерываем его работу через *ctrl + C* и далее вызываем две следующие команды:
```
minikube stop
minikube delete
```
